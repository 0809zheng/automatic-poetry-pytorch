# automatic-poetry-pytorch
Pytorch实现自动写唐诗、写藏头诗。

数据集采用chinese-poetry数据集，地址：https://github.com/chinese-poetry/chinese-poetry

实验提供预处理过的数据集，含有57580首唐诗，每首诗限定在125词，不足125词的以```</s>```填充。数据集以npz文件形式保存，包含三个部分：
- （1）data: 诗词数据，将诗词中的字转化为其在字典中的序号表示。
- （2）ix2word: 序号到字的映射
- （3）word2ix: 字到序号的映射

实验使用Pytorch框架搭建了一个由词嵌入层、两个LSTM层和输出层组成的基于字符的语言模型，结构如下：

![](https://pic.downk.cc/item/5e983d95c2a9a83be57d1912.jpg)

### 1.生成唐诗

**输入**：

湖光秋月两相和

**输出**：

湖光秋月两相和, 一片云中一片红。

一片玉壺金翡翠, 一枝红叶绿苔生。

玉阶金缕金钗白，玉笛声声啼夜啼。

一夜风吹花影落，一声啼鸟啼猨啼。

### 2.生成藏头诗

**输入**：

湖光秋月

**输出**：

湖上春风吹，春风吹落花。

光阴一片月，一片绿苔生。

秋风吹落日，白日照寒烟。

月色连天远，江云入海门。
